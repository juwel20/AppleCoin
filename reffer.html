<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Refer</title>
    <link rel="stylesheet" href="reffer.css">
</head>
<body>
    <div class="game-container">
        <div class="level">LEVEL 01</div>
        
        <!-- Referral Link Section -->
        <div class="referral-link">
            <strong>Your Referral Link is:</strong><br>
            <div class="link-container">
                <span class="link">http://xmjhaxx.com/?ref=<span id="referral-code"></span></span>
                <button class="copy-button" onclick="copyLink()">Copy</button>
            </div>
        </div>

        <!-- Friends Section -->
        <div class="friends">
            <strong>Your Friends:</strong>
            <ul id="friends-list">
                <!-- Friends will be dynamically populated here -->
            </ul>
        </div>

        <!-- Navigation Buttons -->
        <div class="button-container">
            <a href="index.html"><button>Tap</button></a>
            <a href="task.html"><button>Task</button></a>
            <a href="withdraw.html"><button>Withdraw</button></a>
        </div>
    </div>

    <script>
        // Example user ID for this session (you can generate this or retrieve from a server)
        let currentUserID = 'user123'; // This would ideally come from a backend or login session

        // Function to get referral code (based on user ID)
        function getReferralCode() {
            return currentUserID;
        }

        // Display the referral link with the user's unique code
        document.getElementById('referral-code').textContent = getReferralCode();

        // Function to copy the referral link to clipboard
        function copyLink() {
            const linkText = `http://xmjhaxx.com/?ref=${getReferralCode()}`;
            navigator.clipboard.writeText(linkText).then(() => {
                alert('Referral link copied to clipboard!');
            }).catch(err => {
                console.error('Error copying text: ', err);
            });
        }

        // Retrieve stored friends from localStorage
        function getFriends() {
            let friends = JSON.parse(localStorage.getItem('friends')) || [];
            return friends;
        }

        // Add a new friend to the user's friend list
        function addFriend(friendName) {
            let friends = getFriends();
            friends.push(friendName);
            localStorage.setItem('friends', JSON.stringify(friends));
        }

        // Populate the friends list dynamically
        function displayFriends() {
            const friendsList = document.getElementById('friends-list');
            let friends = getFriends();
            friendsList.innerHTML = ''; // Clear existing list
            
            friends.forEach((friend, index) => {
                const li = document.createElement('li');
                li.textContent = `${index + 1}. ${friend}`;
                friendsList.appendChild(li);
            });
        }

        // Simulate adding a friend (for demo purposes)
        // In real-world usage, this would happen when someone signs up using the referral link
        function simulateFriendSignup(friendName) {
            addFriend(friendName);
            displayFriends(); // Update the UI with the new friend
        }

        // Initialize the page
        displayFriends();

        // For demo, simulate a new friend sign-up
        // In a real app, this would be triggered when someone uses the referral link
        // Uncomment below line to simulate adding a new friend
        // simulateFriendSignup('NewFriend');
    </script>
</body>
</html>
